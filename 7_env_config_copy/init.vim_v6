"===================================================="
call plug#begin('~/.config/nvim/plugged/')

Plug 'arcticicestudio/nord-vim'
Plug 'https://github.com/preservim/vim-indent-guides'
Plug 'ghifarit53/tokyonight-vim'
Plug 'vim-airline/vim-airline-themes'
Plug 'akinsho/bufferline.nvim'
Plug 'mhinz/vim-startify'
Plug 'liuchengxu/space-vim-theme'
Plug 'vim-airline/vim-airline'
Plug 'connorholyday/vim-snazzy'
Plug 'vim-airline/vim-airline-themes'
Plug 'mhinz/vim-startify'
Plug 'cocopon/iceberg.vim'
Plug 'marcopaganini/termschool-vim-theme'
Plug 'arcticicestudio/nord-vim'
Plug 'embark-theme/vim', { 'as': 'embark', 'branch': 'main' }
Plug 'neoclide/coc.nvim', {'branch': 'release'}
Plug 'preservim/nerdtree'
Plug 'vim-scripts/taglist.vim'
Plug 'ryanoasis/vim-devicons'
Plug 'gko/vim-coloresque'
Plug 'will133/vim-dirdiff'
Plug 'https://github.com/preservim/tagbar'

call plug#end()
"====================================================="
set smarttab
set tabstop=4
set shiftwidth=4

set softtabstop=0       " å…³é—­softtabstop æ°¸è¿œä¸è¦å°†ç©ºæ ¼å’Œtabæ··åˆè¾“å…¥
set ruler
set magic

set clipboard=unnamed  "å…±äº«å‰ªè´´æ¿

set autoindent
set smartindent
let mapleader = ";"     "è®©<leader> å˜æˆç©ºæ ¼,å¯ä»¥è¯•è¯•ç”¨ï¼›ä»£æ›¿
syntax on
set backspace=indent,eol,start
set softtabstop=4
set wrap                " è®©è¡Œä¸è¶…è¿‡å½“å‰çš„çª—å£é™å®š
set wildmenu            "å‘½ä»¤æ¨¡å¼ä¸‹å¯ä»¥è¡¥å…¨å‘½ä»¤
set incsearch           "è¾¹è¾“å…¥è¾¹é«˜äº®
set ignorecase          "å¿½ç•¥å¤§å°å†™
set smartcase           "æ™ºèƒ½è¯†åˆ«å¤§å°å†™
set scrolloff=5         "æ°¸è¿œè®©æœ€åº•ä¸‹æ˜¾ç¤º5è¡Œå†…å®¹
set encoding=utf-8
set number
"set foldenable
"set foldmethod=manual
"set foldmethod=syntax
"ä¿®æ”¹é”®ä½ï¼Œä½¿ç”¨ç©ºæ ¼é”®æ‰“å¼€å‡½æ•°
":nnoremap <space> za
":nnoremap <leader><space> zn
"å–æ¶ˆäº®èƒŒæ™¯è‰²
"highlight Folded guibg=NONE ctermbg=NONE


"==========ç¼©è¿›çº¿
"let g:indent_guides_guide_size = 1



"=====æŠ˜å ç›¸å…³å†…å®¹ï¼š
"za æ‰“å¼€/å…³é—­å½“å‰æŠ˜å 
"zc å…³é—­å½“å‰æ‰“å¼€çš„æŠ˜å 
"zo æ‰“å¼€å½“å‰çš„æŠ˜å 
"zm å…³é—­æ‰€æœ‰æŠ˜å 
"zM å…³é—­æ‰€æœ‰æŠ˜å åŠåµŒå¥—çš„æŠ˜å 
"zr æ‰“å¼€
"zR æ‰“å¼€æ‰€æœ‰
"zj ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæŠ˜å 
"zk ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªæŠ˜å 
"zn ç¦ç”¨æŠ˜å 
"zN å¯ç”¨æŠ˜å 
":mkview ä¿å­˜å½“å‰æŠ˜å çŠ¶æ€
":loadview è½½å…¥æŠ˜å ä¿¡æ¯
":nnoremap <leader>f zn<CR>
":nnoremap <leader>F zN<CR>

set showmatch  " é«˜äº®æ˜¾ç¤ºåŒ¹é…çš„æ‹¬å·

"let g:Tlist_Ctags_Cmd='/usr/bin/ctags'

"Error resolve: You need to do 'brew install ctags' first
let g:Tlist_Ctags_Cmd='/opt/homebrew/bin/ctags'



"=======================================é”®ä½ä¿®æ”¹ï¼ˆEmacs ç›¸åŒé”®ä½ï¼‰=======================================
imap<C-f>  <Right>
imap<C-p>  <Up>
imap<C-n>  <Down>
imap<C-b>  <Left>
imap<C-a>  <Home>
imap<C-e>  <End>
imap<C-d>  <Delete>
imap<C-h>  <Backspace>
imap<LEADER>w <Esc><Right>
imap<C-k>  <Esc><Right>v<End><Left><Delete>i<Right>


"<<------------------->>
map <LEADER>os :set spell<CR>
map <LEADER>cs :set spell!<CR>
map <LEADER>on :set number<CR>
map <LEADER>cn :set nonumber<CR>

:map<C-f> <Right> 
:map<C-p> <Up>
:map<C-n> <Down>
:map<C-b> <Left>
:map<C-a> <Home>
:map<C-e> <End>

"<<-------------------Table çš„ç¿»é¡µå¿«æ·é”®------------------->>
nmap [[  <C-PageUp>
nmap ]]  <C-PageDown>
"<<-------------------Bufferçš„ç¿»é¡µå¿«æ·é”®------------------->>
nmap <S-Tab> :bp<CR> 
nmap <Tab> :bn<CR>

noremap <LEADER><CR> :nohlsearch<CR> "æœç´¢åå–æ¶ˆé«˜äº®
map R :source $MYVIMRC<CR> "åˆ·æ–°é…ç½®
map s <nop>
"map <LEADER>s :w<CR>
map <LEADER>w :w<CR>
map <LEADER>q :q<CR>


"========å¤šè¡Œæ³¨é‡Šå¿«æ·é”®
" å¤šè¡Œæ³¨é‡Š
vnoremap <leader>/ :s/^/\/\/ /<CR>:nohlsearch<CR>
" å¤šè¡Œç¼©è¿›
vnoremap <tab> :s/^/\t/g<cr>:nohlsearch<CR>
"vnoremap <Tab> >gv
"vnoremap <S-Tab> <gv


"<<-------------------æ‰©å¤§ç¼©å°çª—å£------------------->>
"map <C-l> :vertical resize +5<CR>
"map <C-h> :vertical resize -5<CR>
"map <C-k> :resize -5<CR>
"map <C-j> :resize +5<CR>


"==== COCæŒ‰é”®
" å°†Ctrl-yçš„åŠŸèƒ½æ›´æ”¹ä¸ºPlugçš„Enteré”®
"nmap <Plug>(coc-cursors-select-next) <Plug>(coc-cursors-select)
"nmap <Plug>(coc-cursors-select-previous) <Plug>(coc-cursors-select)
"nmap <Plug>(coc-cursors-select-next-column) <Plug>(coc-cursors-select)
"nmap <Plug>(coc-cursors-select-previous-column) <Plug>(coc-cursors-select)
"nmap <Plug>(coc-cursors-select-all) <Plug>(coc-cursors-select)
"nmap <Plug>(coc-cursors-select-reset) <Plug>(coc-cursors-select)
"nmap <CR> <Plug>(coc-cursors-select)
"inoremap <expr> <CR> pumvisible() ? "\<Plug>confirm_completion" : "\<CR>"

" è®¾ç½® <Enter> ä½œä¸ºç¡®è®¤è‡ªåŠ¨å®Œæˆèœå•çš„å¿«æ·é”®
"imap <expr> <Plug>confirm_completion coc#_select_confirm()



"======== Color ========

"settransparency=10  å¯èƒ½æ˜¯Vimçš„å‘½ä»¤,è°ƒèŠ‚é€æ˜åº¦
set termguicolors
let g:space_vim_transp_bg = 1 "è¿™ä¸ªè¦å…ˆæ”¾ä¸Šé¢
"set background = "light"
"set background = "dark"
"colorscheme iceberg
"colorscheme embark
"color space_vim_theme
"colorscheme herald
colorscheme default
""======================AirLine Setting=========================
  let g:airline_left_sep = 'î‚°'
  let g:airline_left_alt_sep = 'î‚±'
  let g:airline_right_sep = 'î‚²'
  let g:airline_right_alt_sep = 'î‚³'
" Vim åœ¨ä¸å±å¹•/é”®ç›˜äº¤äº’æ—¶ä½¿ç”¨çš„ç¼–ç (å–å†³äºå®é™…çš„ç»ˆç«¯çš„è®¾å®š)
  set encoding=utf-8
  set langmenu=zh_CN.UTF-8
" è®¾ç½®æ‰“å¼€æ–‡ä»¶çš„ç¼–ç æ ¼å¼
  set fileencodings=ucs-bom,utf-8,cp936,gb18030,big5,euc-jp,euc-kr,latin1
  set fileencoding=utf-8
" è§£å†³èœå•ä¹±ç 
  source $VIMRUNTIME/delmenu.vim
  source $VIMRUNTIME/menu.vim
" è§£å†³consleè¾“å‡ºä¹±ç 
"set termencoding = cp936
" è®¾ç½®ä¸­æ–‡æç¤º
  language messages zh_CN.utf-8
" è®¾ç½®ä¸­æ–‡å¸®åŠ©
  set  helplang=cn
" è®¾ç½®ä¸ºåŒå­—å®½æ˜¾ç¤ºï¼Œå¦åˆ™æ— æ³•å®Œæ•´æ˜¾ç¤ºå¦‚:â˜†
  set ambiwidth=double
" æ€»æ˜¯æ˜¾ç¤ºçŠ¶æ€æ 
  let  laststatus = 2
  let g:airline_powerline_fonts = 1   " ä½¿ç”¨powerlineæ‰“è¿‡è¡¥ä¸çš„å­—ä½“
"  let g:airline_theme="light"      " è®¾ç½®ä¸»é¢˜
  let g:airline_theme="dark"      " è®¾ç½®ä¸»é¢˜
":AirlineTheme nord 
"=======è®¾ç½® Nord ä¸»é¢˜
" å¯ç”¨vim-airline-themes
"let g:airline_theme='nord'
"let g:airline#extensions#tabline#theme = 'nord'





  let g:airline#extensions#tabline#enabled = 1      " å¼€å¯tabline
  let g:airline#extensions#tabline#left_sep = 'î‚°'   "tablineä¸­æœªæ¿€æ´»bufferä¸¤ç«¯çš„åˆ†éš”å­—ç¬¦
  let g:airline#extensions#tabline#left_alt_sep = 'î‚±'      "tablineä¸­bufferæ˜¾ç¤ºç¼–å·
"  let g:airline#extensions#tabline#buffer_nr_show = 1
  let g:airline#extensions#whitespace#enabled = 0
  let g:airline#extensions#whitespace#symbol = '!'
  let g:airline#extensions#tabline#buffer_idx_mode = 1
"  let g:airline#extensions#tabline#buffer_idx_format = {
"  \ '0': '0 ',
"  \ '1': '1 ',
"  \ '2': '2 ',
"  \ '3': '3 ',
"  \ '4': '4 ',
"  \ '5': '5 ',
"  \ '6': '6 ',
"  \ '7': '7 ',
"  \ '8': '8 ',
"  \ '9': '9 '
"  \} " è®© tabe ç¼–å·å˜å¤§ï¼Œæš‚æ—¶ä¸éœ€è¦
"
  nmap <leader>1 <Plug>AirlineSelectTab1
  nmap <leader>2 <Plug>AirlineSelectTab2
  nmap <leader>3 <Plug>AirlineSelectTab3
  nmap <leader>4 <Plug>AirlineSelectTab4
  nmap <leader>5 <Plug>AirlineSelectTab5
  nmap <leader>6 <Plug>AirlineSelectTab6
  nmap <leader>7 <Plug>AirlineSelectTab7
  nmap <leader>8 <Plug>AirlineSelectTab8
  nmap <leader>9 <Plug>AirlineSelectTab9
"  "===============è®°å·ä½=================

  if !exists('g:airline_symbols')
"""å®šä¹‰å‡½æ•°SetTitleï¼Œè‡ªåŠ¨æ’å…¥æ–‡ä»¶å¤´
  let g:airline_symbols = {}
  endif


  "å·¦å´ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿
  let g:airline_left_sep = 'î‚°'
  let g:airline_left_alt_sep = 'î‚±'
  "å³å´ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿
  let g:airline_right_sep = 'î‚²'
  let g:airline_right_alt_sep = 'î‚³'
  let g:airline_symbols.crypt = 'ğŸ”’'    "æš—å·åŒ–ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
  let g:airline_symbols.linenr = 'Â¶'      "è¡Œ
  let g:airline_symbols.maxlinenr = 'ã‘'    "æœ€å¤§è¡Œ
  let g:airline_symbols.branch = 'â­ '    "gitãƒ–ãƒ©ãƒ³ãƒ
  let g:airline_symbols.paste = 'Ï'      "ãƒšãƒ¼ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰
  let g:airline_symbols.spell = 'ê¨'      "ã‚¹ãƒšãƒ«ãƒã‚§ãƒƒã‚¯
  let g:airline_symbols.notexists = 'âˆ„'    "gitã§ç®¡ç†ã•ã‚Œã¦ã„ãªã„å ´åˆ
  let g:airline_symbols.whitespace = 'Î'  "ç©ºç™½ã®è­¦å‘Š(ä½™åˆ†ãªç©ºç™½ãªã©)
"  set guifont=Powerline_Consolas:h14:cANSI

"============AirLine Setting
"
"" ä½¿ç”¨NERDTreeæ’ä»¶æŸ¥çœ‹å·¥ç¨‹æ–‡ä»¶ã€‚è®¾ç½®å¿«æ·é”®
nnoremap <silent> <Leader>n  :NERDTreeToggle <CR> 
" è®¾ç½®NERDTreeå­çª—å£ä½ç½®
let NERDTreeWinPos="left"
" è®¾ç½®å¿½ç•¥çš„æ–‡ä»¶
let NERDTreeIgnore=['\.vim$', '\~$', '\.o$', '\.d$', '\.a$', '\.out$', '\.tgz$']
"
"åœ¨VIMå¯åŠ¨æ—¶è‡ªåŠ¨å¼€å¯NerdTree
"autocmd VimEnter * NERDTree
"

" ä½¿ç”¨TlistToggleæŸ¥çœ‹æ–‡ä»¶å‡½æ•°åˆ—è¡¨ã€‚è®¾ç½®å¿«æ·é”®ï¼š<F12>
nnoremap  <Leader>m  :TlistToggle <CR> 
" ç²˜è´´åˆ°ç³»ç»Ÿå‰ªåˆ‡æ¿
"map <Leader>y "*y
"ç¦æ­¢è‡ªåŠ¨æ”¹å˜å½“å‰Vimçª—å£çš„å¤§å°
let Tlist_Inc_Winwidth=0
"æŠŠæ–¹æ³•åˆ—è¡¨æ”¾åœ¨å±å¹•çš„å³ä¾§
let Tlist_Use_Right_Window=1
"let Tlist_Use_Left_Window=0
"è®©å½“å‰ä¸è¢«ç¼–è¾‘çš„æ–‡ä»¶çš„æ–¹æ³•åˆ—è¡¨è‡ªåŠ¨æŠ˜å èµ·æ¥
"let Tlist_File_Fold_Auto_Close=1


"========= Neovim config 
let g:loaded_node_provider = 0
let g:loaded_ruby_provider = 0
let g:loaded_perl_provider = 0

set encoding=utf-8
set updatetime=100

"ç¦»å¼€æ–‡ä»¶æ—¶ä¸æç¤º'æœªä¿å­˜'
set hidden

"è¡Œå·å…±äº«
set signcolumn=number

" è®© TAB é”®ä½å½“åšè¡¥å…¨çš„ç¡®è®¤é”®
inoremap <silent><expr> <TAB>
      \ coc#pum#visible() ? coc#pum#next(1) :
      \ CheckBackspace() ? "\<Tab>" :
      \ coc#refresh()
inoremap <expr><S-TAB> coc#pum#visible() ? coc#pum#prev(1) : "\<C-h>"

" Make <CR> to accept selected completion item or notify coc.nvim to format
" <C-g>u breaks current undo, please make your own choice
inoremap <silent><expr> <CR> coc#pum#visible() ? coc#pum#confirm()
                              \: "\<C-g>u\<CR>\<c-r>=coc#on_enter()\<CR>"

function! CheckBackspace() abort
  let col = col('.') - 1
  return !col || getline('.')[col - 1]  =~# '\s'
endfunction

" æŠ¥é”™ä¹‹é—´åˆ‡æ¢
nmap <silent> [g <Plug>(coc-diagnostic-prev)
nmap <silent> ]g <Plug>(coc-diagnostic-next)

" åŒä¸€ä¸ªå•è¯é«˜äº®
autocmd CursorHold * silent call CocActionAsync('highlight')

""========== tagbar
nmap <leader>f :TagbarToggle<CR>

